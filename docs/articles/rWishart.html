<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>rWishart: An R package for random wishart matrices • rWishart</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rWishart</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="https://www.bearstatistics.com">@ bearstatistics.com</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="https://github.com/benbarnard/rwishart">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>rWishart: An R package for random wishart matrices</h1>
                        <h4 class="author">Ben Barnard and Dean Young</h4>
            
          </div>

    
    
<div class="contents">
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#introduction" class="anchor"> </a></body></html>Introduction</h1>
</div>
<div id="random-wishart-matrices" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#random-wishart-matrices" class="anchor"> </a></body></html>Random Wishart Matrices</h1>
<p>Let <span class="math inline">\(\textbf{X}_{n \times p}\)</span> be a <span class="math inline">\(n\)</span> sample by <span class="math inline">\(p\)</span> dimensional data matrix distributed <span class="math inline">\(MVN(\mu, \Sigma)\)</span>. Let us consider the sample covariance matrix <span class="math display">\[\textbf{S}_i = \frac{1}{n_i - 1}\textbf{X}_i^T \left( \textbf{I}_{n_i} - \frac{1}{n_i} \textbf{J}_{n_i} \right) \textbf{X}_i, \quad i = 1, \ldots, k\]</span> where <span class="math inline">\(\textbf{J}_{n_i}\)</span> is an <span class="math inline">\(n_i \times n_i\)</span> matrix of ones. Then, <span class="math inline">\((n_i - 1) \textbf{S}_i \sim \text{W}\left( \boldsymbol{\Sigma}_i, n_i - 1\right)\)</span>, where <span class="math inline">\(\text{W}\left( \boldsymbol{\Sigma}_i, n_i \right)\)</span> is a Wishart distribution with <span class="math inline">\(n_i\)</span> degrees of freedom and covariance matrix <span class="math inline">\(\boldsymbol{\Sigma}_i\)</span> <span class="citation">(Chaipitak and Chongcharoen 2013; Johnson and Wichern 2007; Fujikoshi, Ulyanov, and Shimizu 2011)</span>.</p>
<p><span class="citation">Odell and Feiveson (1966)</span> has developed an alorithm to generate <span class="math inline">\((n_i - 1) \textbf{S}_i \sim \text{W}\left( \boldsymbol{\Sigma}_i, n_i - 1 \right)\)</span> where <span class="math inline">\(n_i - 1 \geq p\)</span>. The <span class="citation">Odell and Feiveson (1966)</span> algorithm uses Bartlett’s decomposition. Thus, <span class="math inline">\(\textbf{U} = \textbf{FF}^T \sim \text{W}(n - 1, \textbf{I})\)</span>, where <span class="math display">\[\textbf{F} = 
\begin{pmatrix} 
X_1^{1/2} &amp; 0 &amp; \ldots &amp; 0 \\
Y_{2, \ 1} &amp; X_2^{1/2} &amp; \ldots &amp; 0 \\
\vdots &amp; \ddots &amp; \ddots &amp; \vdots \\
Y_{p, \ 1} &amp; \ldots &amp; Y_{p, \ p - 1} &amp; X_p^{1/2}
\end{pmatrix}.\]</span></p>
<p>With <span class="math inline">\(X_i \sim \chi^2(n-i), \ i = 1, \ldots, p\)</span>, and <span class="math inline">\(Y_{i, j} \overset{iid}{\sim} N(0,1)\)</span>. Let <span class="math inline">\(\boldsymbol{\Sigma} = \textbf{CC}^T\)</span> where <span class="math inline">\(\textbf{C}\)</span> is the lower triangle matrix from the Cholesky decomposition. Then, <span class="math inline">\(\textbf{CUC}^T \sim \text{W}\left( \boldsymbol{\Sigma}_i, n_i - 1 \right).\)</span></p>
<div id="psuedo-wishart-matrices" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#psuedo-wishart-matrices" class="anchor"> </a></body></html>Psuedo Wishart Matrices</h2>
<p>In this section we discuss psuedo wishart matrices. <span class="citation">M. S. Srivastava (2003)</span>, <span class="citation">Kubokawa and Srivastava (2008)</span>, and <span class="citation">Uhlig (1994)</span> defined the singular wishart distribution as a <span class="math inline">\(W(n - 1, \boldsymbol{\Sigma})\)</span> where <span class="math inline">\(n \leq p\)</span>, <span class="math inline">\(p\)</span> being the dimension. Since we will define the singular wishart as something else in the next section we will call this the psuedo wishart distribution like <span class="citation">Diaz-Garcia, Jaimez, and Mardia (1997)</span>. We cannot generate our psuedo wishart matrices by <span class="citation">Odell and Feiveson (1966)</span>. Let <span class="math inline">\(X_{n, \ p} \sim MVN(\textbf{0}, \textbf{I}_p)\)</span> where the sample size <span class="math inline">\(n\)</span> is less than our dimension <span class="math inline">\(p\)</span>. Then, <span class="math inline">\(\textbf{W} = \textbf{XX}^T \sim W(n, \textbf{I})\)</span> is psuedo wishart. Next, let <span class="math inline">\(\boldsymbol{\Sigma}\)</span> be positive definite then <span class="math inline">\(\boldsymbol{\Sigma} = \textbf{CC}^T\)</span> where <span class="math inline">\(\textbf{C}\)</span> is the lower triangle matrix from the Cholesky decomposition. Then, <span class="math inline">\(\textbf{CWC}^T \sim \text{W}\left(n, \boldsymbol{\Sigma} \right)\)</span> is psuedo wishart.</p>
</div>
<div id="singular-wishart-matrices" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#singular-wishart-matrices" class="anchor"> </a></body></html>Singular Wishart Matrices</h2>
<p>In this section we discuss singular wishart matrices. We define the singular wishart matrix <span class="math inline">\(W \sim \text{W}(n, \boldsymbol{\Sigma})\)</span> where <span class="math inline">\(\boldsymbol{\Sigma}\)</span> is positive semidefinite where <span class="math inline">\(rk(\boldsymbol{\Sigma}) &lt; p\)</span>. The solution to the Cholesky decomposition is no longer unique and most software will give errors or interesting results. Let <span class="math inline">\(X_{n, \ p} \sim MVN(\textbf{0}, \textbf{I}_p)\)</span>. Then, <span class="math inline">\(\textbf{W} = \textbf{XX}^T \sim W(n, \textbf{I})\)</span> where <span class="math inline">\(W(n, \textbf{I})\)</span> can be wishart or psuedo wishart. Next, let <span class="math inline">\(\boldsymbol{\Sigma}\)</span> be positive semidefinite then <span class="math inline">\(\boldsymbol{\Sigma} = \textbf{UDU}^T\)</span> is the singular value decomposition. Then, <span class="math inline">\(\textbf{UD}^{1/2}\textbf{W}(\textbf{UD}^{1/2})^T \sim \text{W}\left(n, \boldsymbol{\Sigma} \right)\)</span> is singular wishart.</p>
</div>
<div id="fractional-wishart-matrices" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#fractional-wishart-matrices" class="anchor"> </a></body></html>Fractional Wishart Matrices</h2>
<p>In this section we discuss fractional wishart matrices. We define the fractional wishart matrix <span class="math inline">\(W \sim \text{W}(df, \boldsymbol{\Sigma})\)</span> where <span class="math inline">\(\boldsymbol{\Sigma}\)</span> is positive definite. Similar to <span class="citation">Odell and Feiveson (1966)</span> we define <span class="math inline">\(\textbf{U} = \textbf{FF}^T \sim \text{W}(n - 1, \textbf{I})\)</span>, where <span class="math display">\[\textbf{F} = 
\begin{pmatrix} 
X_1^{1/2} &amp; 0 &amp; \ldots &amp; 0 \\
Y_{2, \ 1} &amp; X_2^{1/2} &amp; \ldots &amp; 0 \\
\vdots &amp; \ddots &amp; \ddots &amp; \vdots \\
Y_{p, \ 1} &amp; \ldots &amp; Y_{p, \ p - 1} &amp; X_p^{1/2}
\end{pmatrix}.\]</span> With <span class="math inline">\(X_i \sim \text{Gamma}(df - i + 1, \ 1/2), \ i = 1, \ldots, p\)</span>, and <span class="math inline">\(Y_{i, j} \overset{iid}{\sim} N(0,1)\)</span>. Let <span class="math inline">\(\boldsymbol{\Sigma} = \textbf{CC}^T\)</span> where <span class="math inline">\(\textbf{C}\)</span> is the lower triangle matrix from the Cholesky decomposition. Then, <span class="math inline">\(\textbf{CUC}^T \sim \text{W}\left(df, \boldsymbol{\Sigma}_i \right).\)</span></p>
</div>
</div>
<div id="overview-and-use-of-the-package" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#overview-and-use-of-the-package" class="anchor"> </a></body></html>Overview and Use of the Package</h1>
<p>In this section we discuss the how users will use the rWishart package. Most users will use one function, . The  function is just a wrapper for four other functions, , , , and . The  function decides which of these four functions are needed to create the appropriate random wishart matrix. The  function is just a wrapper for the base  function in R.</p>
<p>Under the hood the wishart functions use the base  function and the function calls , and  are passed to . The base functions and the replications in the future will be implemented in a lower level programming language. Currently the base  function uses a lower level language so we do slow down the  function by assigning over the base function. We assign over the base function to increse functionality of .</p>
<div id="covariance-matrix-class" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#covariance-matrix-class" class="anchor"> </a></body></html>Covariance Matrix Class</h2>
<p>In this section we discuss a new class of matrix object in R. The primary purpose for this object is not really apparent in the rWishart package and we won’t see some of the true advantages to the covariance class object till the covEst package release. When a user calls the rWishart function,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rWishart.html">rWishart</a></span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">df =</span> <span class="dv">2</span>, <span class="dt">Sigma =</span> <span class="kw">diag</span>(<span class="dv">1</span>, <span class="dv">10</span>), 
              <span class="dt">covariance =</span> <span class="ot">TRUE</span>, <span class="dt">simplify =</span> <span class="ot">FALSE</span>)[[<span class="dv">1</span>]]</code></pre></div>
<p>they are given the option to generate sample covariance matrices, <span class="math inline">\(S\)</span>, where <span class="math display">\[df * S \sim W(df, \boldsymbol{\Sigma}).\]</span> In the covariance class matrix we store a new attribute to the matrix object. We store the degrees of freedom as a formula object. The degrees of freedom can be pulled from the covariance matrix class object by using</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">degreesfreedom &lt;-<span class="st"> </span><span class="kw">attributes</span>(S)$df</code></pre></div>
<p>and we can evaluate the formula by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lazyeval::<span class="kw">f_eval</span>(degreesfreedom)</code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>from the lazyeval package. Having a covariance class matrix object allows us to create covarince specific methods that can differentiate between needing high-dimensional or normal methods. The covarinance class object also allows us not to confuse multivariate data matrices with our random sample covariance matrices.</p>
</div>
<div id="testing-wishart-matrices" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#testing-wishart-matrices" class="anchor"> </a></body></html>Testing Wishart Matrices</h2>
</div>
<div id="simulation-study" class="section level2 unnumbered">
<h2 class="hasAnchor">
<html><body><a href="#simulation-study" class="anchor"> </a></body></html>Simulation Study</h2>
<div id="refs" class="references">
<div id="ref-chaipitak_test_2013">
<p>Chaipitak, Saowapha, and Samruam Chongcharoen. 2013. “A Test for Testing the Equality of Two Covariance Matrices for High-Dimensional Data.” <em>Journal of Applied Sciences</em> 13 (2): 270–77.</p>
</div>
<div id="ref-diaz-garcia_wishart_1997">
<p>Diaz-Garcia, Jose A, Ramon Gutierrez Jaimez, and Kanti V Mardia. 1997. “Wishart and Pseudo-Wishart Distributions and Some Applications to Shape Theory.” <em>Journal of Multivariate Analysis</em> 63 (1): 73–87. doi:<a href="https://doi.org/10.1006/jmva.1997.1689">10.1006/jmva.1997.1689</a>.</p>
</div>
<div id="ref-fujikoshi_multivariate_2011">
<p>Fujikoshi, Yasunori, Vladimir V. Ulyanov, and Ryoichi Shimizu. 2011. <em>Multivariate Statistics: High-Dimensional and Large-Sample Approximations</em>. John Wiley &amp; Sons.</p>
</div>
<div id="ref-johnson_applied_2007">
<p>Johnson, Richard Arnold, and Dean W. Wichern. 2007. <em>Applied Multivariate Statistical Analysis</em>. Pearson Prentice Hall.</p>
</div>
<div id="ref-kubokawa_estimation_2008">
<p>Kubokawa, Tatsuya, and Muni S. Srivastava. 2008. “Estimation of the Precision Matrix of a Singular Wishart Distribution and Its Application in High-Dimensional Data.” <em>Journal of Multivariate Analysis</em> 99 (9): 1906–28. doi:<a href="https://doi.org/10.1016/j.jmva.2008.01.016">10.1016/j.jmva.2008.01.016</a>.</p>
</div>
<div id="ref-odell_numerical_1966">
<p>Odell, P. L., and A. H. Feiveson. 1966. “A Numerical Procedure to Generate a Sample Covariance Matrix.” <em>Journal of the American Statistical Association</em> 61 (313): 199–203. doi:<a href="https://doi.org/10.2307/2283054">10.2307/2283054</a>.</p>
</div>
<div id="ref-srivastava_singular_2003">
<p>Srivastava, M. S. 2003. “Singular Wishart and Multivariate Beta Distributions.” <em>The Annals of Statistics</em> 31 (5): 1537–60. <a href="http://www.jstor.org/stable/3448387" class="uri">http://www.jstor.org/stable/3448387</a>.</p>
</div>
<div id="ref-uhlig_singular_1994">
<p>Uhlig, Harald. 1994. “On Singular Wishart and Singular Multivariate Beta Distributions.” <em>The Annals of Statistics</em> 22 (1): 395–405. <a href="http://www.jstor.org/stable/2242460" class="uri">http://www.jstor.org/stable/2242460</a>.</p>
</div>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#random-wishart-matrices">Random Wishart Matrices</a><ul class="nav nav-pills nav-stacked">
<li><a href="#psuedo-wishart-matrices">Psuedo Wishart Matrices</a></li>
      <li><a href="#singular-wishart-matrices">Singular Wishart Matrices</a></li>
      <li><a href="#fractional-wishart-matrices">Fractional Wishart Matrices</a></li>
      </ul>
</li>
      <li>
<a href="#overview-and-use-of-the-package">Overview and Use of the Package</a><ul class="nav nav-pills nav-stacked">
<li><a href="#covariance-matrix-class">Covariance Matrix Class</a></li>
      <li><a href="#testing-wishart-matrices">Testing Wishart Matrices</a></li>
      <li><a href="#simulation-study">Simulation Study</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://benbarnard.bearstatistics.com">Ben Barnard</a>, Dean Young.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
